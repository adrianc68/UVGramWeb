@inject UVGramWeb.Services.IAuthenticationService AuthenticationService;
@inject NavigationManager NavigationManager;
@inject Services.IAccountService AccountService;

@page "/accounts/edit/"
@using Shared.Data

@if (DataLoaded)
{
    <div class="editprofile">
    <div class="editprofile-content card">
        <sidebar class="editprofile-sidebar">
            <UVGramWeb.Pages.Components.EPSidebar></UVGramWeb.Pages.Components.EPSidebar>
        </sidebar>
        <article class="ep-rightside">
            <form class="ep-editprofile-form">
                <div class="ep-data ep-photo-profile">
                    <div class="epaside-data-container">
                        <div class="userprofile-img-content">
                        </div>
                        @* <UVGramWeb.Shared.UserProfile.UserProfile></UVGramWeb.Shared.UserProfile.UserProfile> *@
                    </div>
                    <div class="ep-data ep-pp-data">
                        <h1>@UserData.username</h1>
                        <button class="btn-link text-decoration-none ">Cambiar foto de perfil</button>
                    </div>
                </div>
                <div class="ep-data">
                    <div class="epaside-data-container">
                        <label class="epaside-data semibold" for="name">Nombre:</label>
                    </div>
                    <div class="ep-input">
                        <input class="form-control" aria-required="false" id="name" placeholder="Nombre" type="text"
                            value="@UserData.name">
                        <div id="help" class="form-text">
                            <p>
                                Para ayudar a que las personas descubran tu cuenta, usa el nombre por el que te conoce
                                la
                                gente, ya sea tu nombre completo, apodo o nombre comercial.
                            </p>
                        </div>

                    </div>
                </div>
                <div class="ep-data">
                    <div class="epaside-data-container">
                        <label class="epaside-data semibold" for="username">Nombre de usuario:</label>
                    </div>
                    <div class="ep-input">
                        <input class="form-control" aria-required="false" id="username" placeholder="Nombre de usuario"
                            type="text" value="@UserData.username">

                        <div id="help" class="form-text">
                            <p>
                                En la mayoría de los casos, podrás volver a cambiar tu nombre de usuario sin problema.
                            </p>
                        </div>
                    </div>
                </div>
                <div class="ep-data">
                    <div class="epaside-data-container">
                        <label class="epaside-data semibold" for="presentation">Presentación:</label>
                    </div>
                    <div class="ep-input">
                        <textarea class="form-control" autocomplete="off" autocorrect="off" type="text"
                            id="presentation" aria-label="Presentacion para tu perfil">
                            @UserData.presentation
                            </textarea>
                    </div>
                </div>
                <div class="ep-data">
                    <div class="epaside-data-container">
                    </div>
                    <div class="ep-input">
                        <div id="help" class="form-text">
                            <h2>Información personal</h2>
                            <p>

                                Proporciona tu información personal, incluso si la cuenta se usa para un negocio, una
                                mascota,
                                etc. Esta información no se incluirá en tu perfil público.
                            </p>
                        </div>
                    </div>
                </div>
                <div class="ep-data">
                    <div class="epaside-data-container">
                        <label class="epaside-data semibold" for="email">Correo electrónico:</label>
                    </div>
                    <div class="ep-input">
                        <input class="form-control" aria-required="false" id="email" placeholder="email" type="text"
                            value="@UserData.email">
                    </div>
                </div>
                <div class="ep-data">
                    <div class="epaside-data-container">
                        <label class="epaside-data semibold" for="phonenumber">Telefono:</label>
                    </div>
                    <div class="ep-input">
                        <input class="form-control" aria-required="false" id="phonenumber" placeholder="Telefono"
                            type="text" value="@UserData.phone_number">
                    </div>
                </div>
                <div class="ep-data">
                    <div class="epaside-data-container">
                        <label class="epaside-data semibold" for="gender">Genero:</label>
                    </div>
                    <div class="ep-input">
                        <select class="form-control" name="gender" id="gender" aria-required="false">
                            <option value="1">Masculino</option>
                            <option value="2">Femenino</option>
                            <option value="3">Indiferente</option>
                        </select>
                    </div>
                </div>
                <div class="ep-data">
                    <div class="epaside-data-container">
                    </div>
                    <div class="ep-input">
                        <div class="actions">
                            <button class="btn btn-primary">Enviar</button>
                            <button class="btn btn-link text-decoration-none">Inhabilitar temporalmente mi
                                cuenta</button>
                        </div>
                    </div>
                </div>
            </form>
        </article>
    </div>
</div>
}

@code {
    private UserData UserData { get; set; }
    private bool DataLoaded { get; set; } = false;

    protected override async Task OnInitializedAsync()
    {
        CheckAuthentication();
        await GetData();
    }

    protected async Task GetData()
    {
        UserData = await AccountService.GetAccountData();
        DataLoaded = true;
        StateHasChanged();
    }

    private void CheckAuthentication()
    {
        if (AuthenticationService.User == null)
        {
            NavigationManager.NavigateTo("/login");
            return;
        }
    }

}